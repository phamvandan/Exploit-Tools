#########################
###python3 code crawl email mpi.gov.vn
#using python3 mpi_mail_test.py | grep @mpi.gov.vn > mail.txt
# cat mail.txt

import requests, re
from bs4 import BeautifulSoup
from datetime import datetime
now = datetime.now() # current date and time
writename = "email_moc_{0}.txt".format(now.strftime("%H_%M_%S"))


file2 = open(writename, 'w+')

for i in range(1, 11): 
	URL = "http://gdtp.xaydung.gov.vn/Hdxd/Congbo?page=" + str(i)
	print(str(URL))

#URL = "https://www.mpi.gov.vn/Pages/danhba.aspx?madv=301&idtype=0"
	page = requests.get(str(URL))

	soup = BeautifulSoup(page.content, 'html.parser')

	emails = re.findall(r'[\w\.-]+@[\w\.-]+', soup.text)
	print(emails)
	for email in emails:
		file2.write("%s\n" %email)
###good for detect
	# file2.write(danhba[2].text.replace("Email: ",""))
	# file2.write("\n")
	# print(danhba[2].text.replace("Email: ",""))

file2.close()



# file2 = open('danhba_mpi_in.txt', 'w+')
# f1 = open('MpiMailLoadFreshResponse.html')
# all_texts = f1.read()

# emails = re.findall(r'[\w\.-]+@[\w\.-]+', all_texts)
# print(emails)
# for email in emails:
# 	file2.write("%s\n" %email)

