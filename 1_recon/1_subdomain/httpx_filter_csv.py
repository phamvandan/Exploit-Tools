import sys
import pandas as pd

for line in sys.stdin:
    line = line.rstrip()
    if '' == line:
        break
filename = line
save_path = filename.split('.')[0] + '.xlsx'
print("Save result to {}".format(save_path))
used_cols = ['input','url','host','final_url','title','status_code','scheme','port','webserver','tech']
my_filtered_csv = pd.read_csv(filename)
my_filtered_csv = my_filtered_csv[used_cols]

# fill missing values for final_url
for ind in my_filtered_csv.index:
    if str(my_filtered_csv['final_url'][ind]).lower() == 'nan':
        my_filtered_csv['final_url'][ind] = my_filtered_csv['scheme'][ind] + '://' + my_filtered_csv['input'][ind]

my_filtered_csv.to_excel(save_path)